{"ast":null,"code":"import _slicedToArray from \"C:\\\\todo-app\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";\nimport _classCallCheck from \"C:\\\\todo-app\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\classCallCheck.js\";\nimport _createClass from \"C:\\\\todo-app\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createClass.js\";\nimport { BehaviorSubject, combineLatest, forkJoin } from \"rxjs\";\nimport { finalize, map, tap } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./employee.service\";\nexport var ManagementDataService = /*#__PURE__*/(function () {\n  var ManagementDataService = /*#__PURE__*/function () {\n    function ManagementDataService(employeesService) {\n      _classCallCheck(this, ManagementDataService);\n\n      this.employeesService = employeesService;\n      this.employees = [];\n      this.offices = [];\n      this.employeesSubject = new BehaviorSubject(this.employees);\n      this.officesSubject = new BehaviorSubject(this.offices);\n      this.isLoadingSubject = new BehaviorSubject(false);\n      this.employees$ = this.employeesSubject.asObservable();\n      this.isLoading$ = this.isLoadingSubject.asObservable();\n      this.noData$ = combineLatest([this.employees$, this.isLoading$]).pipe(map(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            employess = _ref2[0],\n            isLoading = _ref2[1];\n\n        return !isLoading && employess.length;\n      }));\n    }\n\n    _createClass(ManagementDataService, [{\n      key: \"fetchEmployeesAndOffices\",\n      value: function fetchEmployeesAndOffices() {\n        var _this = this;\n\n        this.isLoadingSubject.next(true);\n        return forkJoin([this.employeesService.getEmployees(), this.employeesService.getOffices()]).pipe(tap(function (_ref3) {\n          var _ref4 = _slicedToArray(_ref3, 2),\n              employees = _ref4[0],\n              offices = _ref4[1];\n\n          _this.employees = employees;\n          _this.offices = offices;\n\n          _this.employeesSubject.next(_this.employees);\n\n          _this.officesSubject.next(_this.offices);\n        }), finalize(function () {\n          _this.isLoadingSubject.next(false);\n        }));\n      }\n    }, {\n      key: \"addEmployees\",\n      value: function addEmployees(employee) {\n        var _this2 = this;\n\n        this.isLoadingSubject.next(true);\n        return this.employeesService.addEmployee(employee).pipe(tap(function (data) {\n          _this2.employees = _this2.employees.concat([employee]);\n\n          _this2.employeesSubject.next(_this2.employees);\n        }), finalize(function () {\n          _this2.isLoadingSubject.next(false);\n        }));\n      }\n    }, {\n      key: \"removeEmployee\",\n      value: function removeEmployee(id) {\n        var _this3 = this;\n\n        this.isLoadingSubject.next(true);\n        return this.employeesService.deleteEmployee(id).pipe(tap(function (data) {\n          var employeeIndex = _this3.employees.findIndex(function (e) {\n            return e._id === id;\n          });\n\n          if (employeeIndex > -1) {\n            _this3.employees.splice(employeeIndex, 1);\n          }\n\n          _this3.employees = _this3.employees.concat();\n\n          _this3.employeesSubject.next(_this3.employees);\n        }), finalize(function () {\n          _this3.isLoadingSubject.next(false);\n        }));\n      }\n    }]);\n\n    return ManagementDataService;\n  }();\n\n  ManagementDataService.ɵfac = function ManagementDataService_Factory(t) {\n    return new (t || ManagementDataService)(i0.ɵɵinject(i1.EmployeeService));\n  };\n\n  ManagementDataService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: ManagementDataService,\n    factory: ManagementDataService.ɵfac,\n    providedIn: 'root'\n  });\n  return ManagementDataService;\n})();","map":null,"metadata":{},"sourceType":"module"}